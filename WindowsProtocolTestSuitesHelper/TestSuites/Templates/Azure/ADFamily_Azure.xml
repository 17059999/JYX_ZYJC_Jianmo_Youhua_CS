<lab>
  <core>
    <username>IOLab</username>
    <password>Password01!</password>
    <TestSuiteName>ADFamily</TestSuiteName>
    <regressiontype>Azure</regressiontype>    
    <subnet>10.0.1.0</subnet>
    <timeoutinminutes>720</timeoutinminutes>
  </core>
  <vmsetting>
    <location>westus2</location>
    <networkId>TestSuiteOnAzure-vnet</networkId>
    <subnetName>default</subnetName>
    <resourceGroup>TestSuiteOnAzure</resourceGroup>
    <diskType>Premium_LRS</diskType>
    <vmSize>Standard_F4s_v2</vmSize>
    <fileShareRoot>https://testsuiteshare.file.core.windows.net/protocoltestsuiteshare</fileShareRoot>
    <genevaAccountRegion>westus2</genevaAccountRegion>
  </vmsetting>
  <Parameters>
    <!--Parameters for automation run-->
    <Parameter Name="SelectedProtocols" Value="lsat,schema,drsr,publishdc,frs2,lsad,security,nrpc,ldap,apds,samr" Comment="Select test suite family members to run." />
    <Parameter Name="TestDriverName" Value="ADFamily-EP" Comment="Should be the VM name of the test driver." />
    <Parameter Name="BatchToRun" Value="RunAllTestCases.cmd" Comment="Which batch file to run test case." />
    <Parameter Name="EnableWindowsDebug" Value="false" Comment="Whether to enable the windows debugger." />
  </Parameters>
  <servers>
    <vm>
      <installorder>1</installorder>
      <role>PrimaryDomainController</role>
      <imageReference>
        <publisher>MicrosoftWindowsServer</publisher>
        <offer>WindowsServer</offer>
        <sku>2016-Datacenter</sku>
        <version>latest</version>
      </imageReference>
      <name>ADFamily-PDC</name>
      <isdc>true</isdc>
      <domain>contoso.com</domain>
      <ip>10.0.1.21</ip>
      <dns>10.0.1.22;10.0.1.21;10.0.1.25</dns>
      <alternateDNS>10.0.1.25</alternateDNS>
      <installfeaturescript>Install-ADDS.ps1;Install_RemoteAccess_Feature.ps1;Write-InstallFeatureScirptDone.ps1;RestartComputer.PS1</installfeaturescript>
      <postscript>Config-PDC.ps1</postscript>
      <restartinpostscript>true</restartinpostscript>
      <skipwaitingforpostscript>false</skipwaitingforpostscript>
      <ldsinstancename>instance01</ldsinstancename>
      <ldsldapport>20000</ldsldapport>
      <ldssslport>20001</ldssslport>
      <ldsnewapplicationpartitiontocreate>CN=ApplicationNamingContext</ldsnewapplicationpartitiontocreate>
      <ldsserviceaccount>CONTOSO\IOLab</ldsserviceaccount>
      <ldsservicepassword>Password01!</ldsservicepassword>
      <ldsadministrator>CONTOSO\IOLab</ldsadministrator>
      <ldssourceusername>CONTOSO\IOLab</ldssourceusername>
      <ldssourcepassword>Password01!</ldssourcepassword>
      <clientname>ADFamily-EP</clientname>
      <clientuser>userADTSSecurity</clientuser>
      <userpassword>Password01!</userpassword>
      <CAroot>EnterpriseRootCA</CAroot>
      <trusttargetdomain>trust.com</trusttargetdomain>
      <trustpassword>Password01!</trustpassword>
      <msaname>msa01</msaname>
      <msapassword>Password01!</msapassword>
    </vm>
    <vm>
      <installorder>2</installorder>
      <role>SecondaryDomainController</role>
      <imageReference>
        <publisher>MicrosoftWindowsServer</publisher>
        <offer>WindowsServer</offer>
        <sku>2016-Datacenter</sku>
        <version>latest</version>
      </imageReference>
      <name>ADFamily-SDC</name>
      <isdc>true</isdc>
      <domain>contoso.com</domain>
      <ip>10.0.1.22</ip>
      <dns>10.0.1.21</dns>
      <installfeaturescript>Install-ADDS.ps1;Write-InstallFeatureScirptDone.ps1</installfeaturescript>
      <postscript>Config-SDC.ps1</postscript>
      <restartinpostscript>true</restartinpostscript>
      <skipwaitingforpostscript>false</skipwaitingforpostscript>
      <replicasourcedc>ADFamily-PDC.contoso.com</replicasourcedc>
    </vm>

    <vm>
      <installorder>3</installorder>
      <role>ReadOnlyDomainController</role>
      <imageReference>
        <publisher>MicrosoftWindowsServer</publisher>
        <offer>WindowsServer</offer>
        <sku>2016-Datacenter</sku>
        <version>latest</version>
      </imageReference>
      <name>ADFamily-RODC</name>
      <isdc>true</isdc>
      <domain>contoso.com</domain>
      <ip>10.0.1.23</ip>
      <dns>10.0.1.21</dns>
      <installfeaturescript>Install-ADDS.ps1;Write-InstallFeatureScirptDone.ps1</installfeaturescript>
      <postscript>Config-RODC.ps1</postscript>
      <restartinpostscript>true</restartinpostscript>
      <skipwaitingforpostscript>false</skipwaitingforpostscript>
      <replicasourcedc>ADFamily-PDC.contoso.com</replicasourcedc>
    </vm>
    <vm>
      <installorder>4</installorder>
      <role>ChildDomainController</role>
      <imageReference>
        <publisher>MicrosoftWindowsServer</publisher>
        <offer>WindowsServer</offer>
        <sku>2016-Datacenter</sku>
        <version>latest</version>
      </imageReference>
      <name>ADFamily-CDC</name>
      <isdc>true</isdc>
      <domain>child.contoso.com</domain>
      <ip>10.0.1.24</ip>
      <dns>10.0.1.21</dns>
      <installfeaturescript>Install-ADDS.ps1;Write-InstallFeatureScirptDone.ps1</installfeaturescript>
      <postscript>Config-CDC.ps1</postscript>
      <restartinpostscript>true</restartinpostscript>
      <skipwaitingforpostscript>false</skipwaitingforpostscript>
      <primarydc>ADFamily-PDC.contoso.com</primarydc>
      <secondarydc>ADFamily-SDC.contoso.com</secondarydc>
      <secondarydcip>10.0.1.22</secondarydcip>
      <parentdomain>contoso.com</parentdomain>
    </vm>
    <vm>
      <installorder>5</installorder>
      <role>TrustedDomainController</role>
      <imageReference>
        <publisher>MicrosoftWindowsServer</publisher>
        <offer>WindowsServer</offer>
        <sku>2016-Datacenter</sku>
        <version>latest</version>
      </imageReference>
      <name>ADFamily-TDC</name>
      <isdc>true</isdc>
      <domain>trust.com</domain>
      <ip>10.0.1.25</ip>
      <dns>10.0.1.21;10.0.1.25</dns>
      <alternateDNS>10.0.1.21</alternateDNS>
      <installfeaturescript>Install-ADDS.ps1;Write-InstallFeatureScirptDone.ps1</installfeaturescript>
      <postscript>Config-TDC.ps1</postscript>
      <restartinpostscript>true</restartinpostscript>
      <skipwaitingforpostscript>false</skipwaitingforpostscript>
      <trusttargetdomain>contoso.com</trusttargetdomain>
      <trustpassword>Password01!</trustpassword>
      <trusttargetserver>ADFamily-PDC.contoso.com</trusttargetserver>
      <trusttargetuser>CONTOSO\IOLab</trusttargetuser>
      <trusttargetpwd>Password01!</trusttargetpwd>
    </vm>
    <vm>
      <installorder>6</installorder>
      <role>DomainMember</role>
      <imageReference>
        <publisher>MicrosoftWindowsServer</publisher>
        <offer>WindowsServer</offer>
        <sku>2016-Datacenter</sku>
        <version>latest</version>
      </imageReference>
      <name>ADFamily-DM</name>
      <domain>contoso.com</domain>
      <ip>10.0.1.26</ip>
      <dns>10.0.1.21</dns>
      <postscript>Config-DM.ps1</postscript>
      <restartinpostscript>true</restartinpostscript>
      <skipwaitingforpostscript>false</skipwaitingforpostscript>
      <primarydc>ADFamily-PDC.contoso.com</primarydc>
      <secondarydc>ADFamily-SDC.contoso.com</secondarydc>
      <temppassword>Password02@</temppassword>
    </vm>
    <vm>
      <installorder>7</installorder>
      <role>DriverComputer</role>
      <imageReference>
        <imageRefId>Win101803_VS2017</imageRefId>
      </imageReference>
      <name>ADFamily-EP</name>
      <domain>contoso.com</domain>
      <ip>10.0.1.27</ip>
      <dns>10.0.1.21;10.0.1.24;10.0.1.25</dns>
      <alternateDNS>10.0.1.25</alternateDNS>
      <postscript>InstallMSIAndTools.ps1;SetPasswordNeverExpires.ps1;Update-VisualStudioLicense.ps1;Config-ENDPOINT.ps1</postscript>
      <restartinpostscript>true</restartinpostscript>
      <skipwaitingforpostscript>false</skipwaitingforpostscript>
      <tools>
        <tool name="SE" MSIName="SpecExplorer.msi" version="3.5.3146.0" CPUArchitecture="x86" />
        <tool name="PTF" MSIName="ProtocolTestFrameworkInstaller.msi" version="1.0.7500.0" CPUArchitecture="x86" />
        <tool name="MMA" MSIName="MessageAnalyzer64.msi" version="1.20.0107.01" CPUArchitecture="x64" />
        <tool name="OpenXMLSDK" MSIName="OpenXMLSDKV25.msi" version="2.5.5631.0" CPUArchitecture="x86" />
        <TestsuiteMSI MSIName="ADFamily-TestSuite-ServerEP.msi" targetEndpoint="TESTSUITE" />
      </tools>
      <primarydc>ADFamily-PDC.contoso.com</primarydc>
      <primarydcip>10.0.1.21</primarydcip>
      <secondarydc>ADFamily-SDC.contoso.com</secondarydc>
      <secondarydcip>10.0.1.22</secondarydcip>
      <readonlydc>ADFamily-RODC.contoso.com</readonlydc>
      <readonlydcip>10.0.1.23</readonlydcip>
      <childdc>ADFamily-CDC.child.contoso.com</childdc>
      <childdcip>10.0.1.24</childdcip>
      <trustdc>ADFamily-TDC.trust.com</trustdc>
      <trustdcip>10.0.1.25</trustdcip>
      <dm>ADFamily-DM.contoso.com</dm>
      <dmip>10.0.1.26</dmip>
      <clientuser>userADTSSecurity</clientuser>
      <userpassword>Password01!</userpassword>
      <temppassword>Password02@</temppassword>
    </vm>
  </servers>
</lab>